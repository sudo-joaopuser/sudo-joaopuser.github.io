<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EvolutionX - Details</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="../style.css">
</head>
<body>

    <nav class="sidebar">
        <div class="top-section">
            <div class="profile-icon">
                <span class="material-symbols-outlined">account_circle</span>
            </div>
            <button class="menu-btn">
                <span class="material-symbols-outlined">menu</span>
            </button>
        </div>

        <div class="nav-links">
            <a href="../index.html" class="menu-btn" style="text-decoration: none;">
                <span class="material-symbols-outlined">star</span>
                <span>Home</span>
            </a>

            <a href="../roms.html" class="menu-btn active" style="text-decoration: none;">
                <div class="icon-box">
                    <span class="material-symbols-outlined">stars</span>
                </div>
                <span>Roms</span>
            </a>

            <a href="../about.html" class="menu-btn" style="text-decoration: none;">
                <span class="material-symbols-outlined">account_circle</span>
                <span>About</span>
            </a>
        </div>
    </nav>

    <main class="main-content">
        <header>
            <a href="../roms.html" style="color: inherit; text-decoration: none; display: flex; align-items: center;">
                <span class="material-symbols-outlined back-arrow">arrow_back</span>
                <span>Back to Home</span>
            </a>
        </header>

        <div class="hero-card post-hero">
            <div class="post-header-content">
                <img src="../assets/evox.png" alt="Logo" class="post-logo">
                <div>
                    <h1>EvolutionX</h1>
                    <div class="tags">
                        <div class="tag">Android 16</div>
                        <div class="tag">Unofficial</div>
                        <div class="tag">Garnet</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="post-container">
            
            <div class="post-details">
                <h2>About</h2>
                <p class="description">
                    EvolutionX is based on LineageOS and currently running on Android 16.
                </p>

                <div class="info-grid">
                    <div class="info-item">
                        <span class="label">Maintainer</span>
                        <span class="value">Jotanh</span>
                    </div>
                    <div class="info-item">
                        <span class="label">Date</span>
                        <span class="value">4/12/2025</span>
                    </div>
                    <div class="info-item">
                        <span class="label">Status</span>
                        <span class="value" style="color: var(--accent-color);">Stable</span>
                    </div>
                </div>

                <h3>Changelog</h3>
                <ul class="changelog-list" id="changelog-container" data-file="../changelogs/evox.txt">
                    <li style="color: var(--text-secondary);">Loading changelog...</li>
                </ul>
            </div>

            <div class="post-actions">
                
                <button id="open-download-modal-btn" class="action-btn primary" style="width: 100%; margin-bottom: 20px;">
                    <span class="material-symbols-outlined">download</span>
                    Download ROM
                </button>

                <a href="https://t.me/joaodoximichat" class="action-btn secondary">
                    <span class="material-symbols-outlined">memory</span>
                    Support
                </a>

                <a href="#screenshots-section" class="action-btn outline">
                    <span class="material-symbols-outlined">image</span>
                    Screenshots
                </a>

                <a href="https://ko-fi.com/joaodoximi" class="action-btn donate-btn">
                    <span class="material-symbols-outlined">favorite</span>
                    Donate
                </a>
            </div>
        </div>

        <div id="download-modal" class="modal">
            <div class="modal-content download-list-modal">
                
                <div class="modal-info-header">Download EvolutionX - Redmi Note 13 Pro / Poco X6 5G</div>
                
                <div id="versions-list-container" class="versions-list-container">
                    <div style="text-align: center; color: var(--text-secondary);">Loading versions...</div>
                </div>

                <div class="modal-footer-list-view">
                    <span id="close-modal-text" class="modal-close-text">Close</span>
                </div>

            </div>
        </div>

        <div id="donation-modal" class="modal">
            <div class="modal-content donation-content">
                <span class="close-btn material-symbols-outlined" id="close-donation-modal">close</span>
                
                <h2>Download started</h2>

                <div class="donation-image-container">
                    <span class="material-symbols-outlined heart-icon">favorite</span>
                </div>
                
                <p class="donation-message">
                    Donations keep the servers running and help us build a better recovery for you.
                    <br><br>
                    Would you like to donate?
                </p>

                <div class="donation-actions">
                    <a href="#" id="next-time-btn" class="action-btn secondary">Next time</a> 
                    <a href="https://ko-fi.com/joaodoximi" id="donate-now-btn" class="action-btn donate-btn">
                        <span class="material-symbols-outlined">favorite</span>
                        Donate
                    </a>
                </div>
            </div>
        </div>
    </main>

    <script>
        const romVersions = [
            {
                version: "11.5 LOSBased",
                variant: "GApps",
                isLatest: true,
                size: "2.9 GB",
                url: "https://pixeldrain.com/u/okhrUjdz",
            },
            {
                version: "11.5 AOSP OLD V",
                variant: "GApps",
                isLatest: false,
                size: "2.7 GB",
                url: "https://drive.usercontent.google.com/download?id=1o1ziQc_Ap0hpU_NI8-xvj91g7gBnx3Rb&export=download",
            },
            {
                version: "11.2.1",
                variant: "GApps",
                isLatest: false,
                size: "Download",
                url: "#",
            }
        ];

        function loadChangelog(filePath, targetElementId) {
            const listContainer = document.getElementById(targetElementId);
            listContainer.innerHTML = '<li style="color: var(--text-secondary);">Loading changelog...</li>';
            
            fetch(filePath)
                .then(response => {
                    if (!response.ok) throw new Error("File not found: " + filePath);
                    return response.text();
                })
                .then(text => {
                    listContainer.innerHTML = '';
                    const lines = text.split('\n');
                    
                    lines.forEach(line => {
                        if (line.trim() !== '') {
                            const li = document.createElement('li');
                            li.textContent = line;
                            listContainer.appendChild(li);
                        }
                    });
                })
                .catch(error => {
                    console.error(error);
                    listContainer.innerHTML = '<li style="color: #ff6b6b;">Erro ao carregar o changelog. Verifique o caminho do arquivo.</li>';
                });
        }
        
        function startDownload(url) {
            window.open(url, '_blank'); 
            document.getElementById('donation-modal').style.display = 'none';
        }

        function prepareDownload(url) {
            document.getElementById('download-modal').style.display = 'none';
            document.getElementById('donation-modal').style.display = 'block';

            const nextTimeBtn = document.getElementById('next-time-btn');
            
            nextTimeBtn.href = url;
        }
        
        function renderVersionsList() {
            const container = document.getElementById('versions-list-container');
            container.innerHTML = ''; 

            romVersions.forEach(rom => {
                const card = document.createElement('div');
                card.classList.add('version-card');

                const infoDiv = document.createElement('div');
                infoDiv.classList.add('version-info');

                const versionText = document.createElement('span');
                versionText.classList.add('version-number');
                versionText.textContent = rom.version;

                if (rom.isLatest) {
                    const latestTag = document.createElement('span');
                    latestTag.classList.add('version-label-tag');
                    latestTag.textContent = 'Latest';
                    versionText.appendChild(latestTag);
                }

                const variantText = document.createElement('span');
                variantText.style.color = 'var(--text-secondary)';
                variantText.textContent = `Variant: ${rom.variant}`;

                infoDiv.appendChild(versionText);
                infoDiv.appendChild(variantText);

                const downloadLink = document.createElement('a');
                downloadLink.classList.add('version-download-btn');
                downloadLink.href = 'javascript:void(0)';
                downloadLink.textContent = rom.size;
                
                downloadLink.onclick = function(event) {
                    event.preventDefault(); 
                    prepareDownload(rom.url); 
                };
                
                card.appendChild(infoDiv);
                card.appendChild(downloadLink);
                
                container.appendChild(card);
            });
            
            document.getElementById('download-modal').style.display = 'block';
        }


        document.addEventListener("DOMContentLoaded", function() {
            const pageChangelogList = document.getElementById('changelog-container');
            const pageChangelogPath = pageChangelogList.getAttribute('data-file');
            if (pageChangelogPath) {
                loadChangelog(pageChangelogPath, 'changelog-container');
            }

            const modal = document.getElementById('download-modal');
            const donationModal = document.getElementById('donation-modal');
            const openModalBtn = document.getElementById('open-download-modal-btn');
            const nextTimeBtn = document.getElementById('next-time-btn');
            const donateNowBtn = document.getElementById('donate-now-btn');

            openModalBtn.onclick = function() {
                renderVersionsList();
            }

            document.getElementById('close-modal-text').onclick = function() {
                 modal.style.display = 'none';
            }
            
            document.getElementById('close-donation-modal').onclick = function() {
                 donationModal.style.display = 'none';
            }

            window.onclick = function(event) {
                if (event.target == modal) {
                    modal.style.display = 'none';
                }
                if (event.target == donationModal) {
                    donationModal.style.display = 'none';
                }
            }

            nextTimeBtn.addEventListener('click', function(event) {
                document.getElementById('donation-modal').style.display = 'none';
            });
            
            donateNowBtn.addEventListener('click', function(event) {
                document.getElementById('donation-modal').style.display = 'none';
            });
        });
    </script>
</body>
</html>